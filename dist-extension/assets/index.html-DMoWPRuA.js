import{d as oe,u as le,r as v,c as u,o as re,g as _,a as b,h as p,b as s,j as R,e as n,f as o,v as f,x as ie,i as z,y as ce,z as ue,t as c,k as g,F as de,l as fe,A as he,B as j,C as pe,D as ve,G as me,H as _e,I as ge,J as ye,_ as be,m as we,p as Te,q as ke,s as Se}from"./_plugin-vue_export-helper-DyC-ivGw.js";import"./security-6RDsp77e.js";const Le={class:"security-popup"},Pe={class:"header"},Ce={class:"logo"},He={class:"status"},ze={class:"security-score"},Ae={class:"score-text"},Be={class:"score-info"},$e={class:"current-page"},Ue={class:"page-info"},xe={class:"url"},De={class:"badges"},Re={class:"stats"},Ve={class:"stat-item"},Ie={class:"stat-number"},Me={class:"stat-item"},Ee={class:"stat-number"},Ne={class:"stat-item"},Oe={class:"stat-number"},je={key:0,class:"recent-threats"},Ke={class:"threat-list"},We={class:"threat-info"},Fe={class:"threat-title"},qe={class:"threat-time"},Ge={class:"actions"},Je={class:"phishing-detector"},Xe={class:"result-header"},Qe=["innerHTML"],Ye={key:1,class:"analyzing-tips"},Ze=oe({__name:"App",setup(V){const r=le(),B=v(!1),C=v("åŠ è½½ä¸­..."),$=v(!1),w=v(""),U=v(!1),T=v(""),k=v(""),S=v(!1),L=v(!0),I=u(()=>r.isActive),m=u(()=>r.securityScore);u(()=>r.settings);const K=u(()=>{try{return new URL(w.value).hostname}catch{return C.value}}),x=u(()=>{const t=K.value;return r.threats.filter(e=>{try{return new URL(e.url).hostname===t}catch{return e.url.includes(t)}})}),M=u(()=>x.value.slice(0,10)),E=u(()=>{const t=x.value,e={totalThreats:t.length,blockedThreats:t.filter(a=>a.blocked).length,allowedThreats:t.filter(a=>!a.blocked).length,threatsByType:{},threatsByLevel:{},lastScanTime:Date.now()};return t.forEach(a=>{e.threatsByType[a.type]||(e.threatsByType[a.type]=0),e.threatsByType[a.type]++}),t.forEach(a=>{e.threatsByLevel[a.level]||(e.threatsByLevel[a.level]=0),e.threatsByLevel[a.level]++}),e}),N=u(()=>{const t=new Date;t.setHours(0,0,0,0);const e=t.getTime();return x.value.filter(a=>a.blocked&&a.timestamp>=e).length}),W=u(()=>m.value>=90?"success":m.value>=70?"warning":"danger"),F=u(()=>m.value>=90?"å®‰å…¨":m.value>=70?"æ³¨æ„":"å±é™©"),q=u(()=>L.value?"safe":"danger"),G=u(()=>L.value?"âœ… ç½‘ç«™å®‰å…¨":"âš ï¸ ç–‘ä¼¼é’“é±¼ç½‘ç«™");function J(t){return t>=90?"#67c23a":t>=70?"#e6a23c":"#f56c6c"}function X(t){return t>=90?"ç½‘ç«™å®‰å…¨æ€§è‰¯å¥½":t>=70?"å­˜åœ¨ä¸€äº›å®‰å…¨é£é™©":"å‘ç°ä¸¥é‡å®‰å…¨é—®é¢˜"}function Q(t){return{low:"#909399",medium:"#e6a23c",high:"#f56c6c",critical:"#f56c6c"}[t]||"#909399"}function Y(t){return{malicious_url:"æ¶æ„URL",xss_attack:"XSSæ”»å‡»",tracker:"éšç§è¿½è¸ª",insecure_form:"ä¸å®‰å…¨è¡¨å•",suspicious_script:"å¯ç–‘è„šæœ¬",phishing:"é’“é±¼ç½‘ç«™"}[t]||"æœªçŸ¥å¨èƒ"}function Z(t){const a=Date.now()-t,l=Math.floor(a/6e4);if(l<1)return"åˆšåˆš";if(l<60)return`${l}åˆ†é’Ÿå‰`;const d=Math.floor(l/60);return d<24?`${d}å°æ—¶å‰`:`${Math.floor(d/24)}å¤©å‰`}async function ee(){B.value=!0;try{await r.scanCurrentPage()}catch(t){console.error("æ‰«æå¤±è´¥:",t)}finally{B.value=!1}}function te(){typeof chrome<"u"&&chrome.runtime&&chrome.runtime.openOptionsPage()}async function se(){if(T.value.trim()){S.value=!0,k.value="";try{const e=await fetch("https://openrouter.ai/api/v1/chat/completions",{method:"POST",headers:{Authorization:"Bearer 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","HTTP-Referer":"https://github.com/web-security-guardian","X-Title":"Web Security Guardian","Content-Type":"application/json"},body:JSON.stringify({model:"tngtech/deepseek-r1t2-chimera:free",messages:[{role:"system",content:"ä½ æ˜¯ä¸€ä¸ªç½‘ç»œå®‰å…¨ä¸“å®¶ï¼Œä¸“é—¨è¯†åˆ«é’“é±¼ç½‘ç«™ã€‚è¯·åˆ†æç”¨æˆ·æä¾›çš„URLï¼Œåˆ¤æ–­æ˜¯å¦ä¸ºé’“é±¼ç½‘ç«™ã€‚å›ç­”è¦ç®€æ´æ˜äº†ï¼ŒåŒ…å«ï¼š1.åˆ¤æ–­ç»“æœï¼ˆå®‰å…¨/å±é™©ï¼‰2.ä¸»è¦åŸå›  3.é£é™©ç­‰çº§ã€‚ç”¨ä¸­æ–‡å›ç­”ï¼Œæ ¼å¼æ¸…æ™°ã€‚"},{role:"user",content:`è¯·åˆ†æè¿™ä¸ªç½‘å€æ˜¯å¦ä¸ºé’“é±¼ç½‘ç«™ï¼š${T.value}

è¯·ä»ä»¥ä¸‹æ–¹é¢åˆ†æï¼š
1. åŸŸåç‰¹å¾ï¼ˆæ˜¯å¦ä»¿å†’çŸ¥åç½‘ç«™ï¼‰
2. URLç»“æ„ï¼ˆæ˜¯å¦æœ‰å¼‚å¸¸å­—ç¬¦æˆ–ç¼–ç ï¼‰
3. é¡¶çº§åŸŸåå¯ä¿¡åº¦
4. æ˜¯å¦åŒ…å«å¯ç–‘å…³é”®è¯
5. ç»¼åˆå®‰å…¨è¯„ä¼°`}]})});if(!e.ok)throw new Error(`APIè¯·æ±‚å¤±è´¥: ${e.status}`);const l=(await e.json()).choices[0].message.content,d=["å±é™©","é’“é±¼","ä¸å®‰å…¨","é£é™©","å¯ç–‘","ä»¿å†’","æ¬ºè¯ˆ"],y=["å®‰å…¨","æ­£å¸¸","å¯ä¿¡","åˆæ³•"],h=d.some(P=>l.includes(P)),H=y.some(P=>l.includes(P));L.value=!h||H&&!l.includes("é«˜é£é™©"),k.value=l.replace(/\n/g,"<br>").replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/###\s*(.*?)(<br>|$)/g,"<h4>$1</h4>")}catch(t){console.error("AIæ£€æµ‹å¤±è´¥:",t),k.value=`<p style="color: #f56c6c;">âŒ æ£€æµ‹å¤±è´¥: ${t instanceof Error?t.message:"æœªçŸ¥é”™è¯¯"}</p><p>è¯·æ£€æŸ¥ç½‘ç»œè¿æ¥æˆ–ç¨åé‡è¯•ã€‚</p>`,L.value=!0}finally{S.value=!1}}}async function O(){try{if(typeof chrome<"u"&&chrome.tabs){const[t]=await chrome.tabs.query({active:!0,currentWindow:!0});t.url&&(w.value=t.url,C.value=new URL(t.url).hostname,$.value=t.url.startsWith("https://"),await D(t.url))}}catch(t){console.error("è·å–é¡µé¢ä¿¡æ¯å¤±è´¥:",t),C.value="æ— æ³•è·å–"}}async function D(t){let e=100,a="";try{a=new URL(t).hostname}catch{a=t}r.stats;const l=r.recentThreats,d=l.filter(h=>{try{return new URL(h.url).hostname===a}catch{return h.url.includes(a)}});d.forEach(h=>{switch(h.level){case"critical":e-=30;break;case"high":e-=20;break;case"medium":e-=10;break;case"low":e-=5;break}});const y=t.includes("localhost")||t.includes("127.0.0.1");!t.startsWith("https://")&&!y&&(e-=15,console.log("âŒ æœªä½¿ç”¨HTTPSï¼Œæ‰£15åˆ†")),e=Math.max(0,Math.min(100,e)),r.currentPageAnalysis={url:t,score:e,threats:d,recommendations:e<90?["å‘ç°å®‰å…¨å¨èƒï¼Œå»ºè®®è°¨æ…æ“ä½œ"]:["ç½‘ç«™å®‰å…¨æ€§è‰¯å¥½"],scanTime:Date.now(),isSecure:e>=90},console.log(`ğŸ” é¡µé¢å®‰å…¨è¯„åˆ†: ${e}`),console.log(`ğŸ“Š å½“å‰é¡µé¢å¨èƒ: ${d.length} / æ€»å¨èƒ: ${l.length}`)}function ae(){typeof chrome<"u"&&chrome.storage&&chrome.storage.onChanged.addListener((t,e)=>{e==="local"&&(console.log("ğŸ“¦ Storage changed:",t),(t.security_stats||t.threat_history)&&(r.loadStats(),r.loadThreats(),w.value&&D(w.value)))})}function ne(){typeof chrome<"u"&&chrome.tabs&&chrome.tabs.onActivated.addListener(async()=>{console.log("ğŸ”„ Tab switched, refreshing page info"),await O()})}return re(async()=>{console.log("ğŸ¨ Popup opened"),await r.initialize(),await O(),ae(),ne(),setInterval(async()=>{await r.loadStats(),await r.loadThreats(),await D(w.value)},2e3)}),(t,e)=>{const a=_("el-icon"),l=_("el-button"),d=_("el-badge"),y=_("el-progress"),h=_("el-tag"),H=_("el-input"),P=_("el-dialog");return p(),b("div",Le,[s("div",Pe,[s("div",Ce,[n(a,{size:"24",color:"#667eea"},{default:o(()=>[n(f(ie))]),_:1}),e[3]||(e[3]=s("h1",null,"å®‰å…¨å®ˆæŠ¤è€…",-1))]),s("div",He,[n(d,{value:N.value,class:"badge"},{default:o(()=>[n(l,{type:I.value?"success":"danger",size:"small",circle:""},{default:o(()=>[n(a,null,{default:o(()=>[I.value?(p(),z(f(ce),{key:0})):(p(),z(f(ue),{key:1}))]),_:1})]),_:1},8,["type"])]),_:1},8,["value"])])]),s("div",ze,[n(y,{type:"circle",percentage:m.value,color:J(m.value),width:80},{default:o(({percentage:i})=>[s("span",Ae,c(i),1)]),_:1},8,["percentage","color"]),s("div",Be,[e[4]||(e[4]=s("h3",null,"å®‰å…¨è¯„åˆ†",-1)),s("p",null,c(X(m.value)),1)])]),s("div",$e,[e[5]||(e[5]=s("h3",null,"å½“å‰é¡µé¢",-1)),s("div",Ue,[s("div",xe,c(C.value),1),s("div",De,[n(h,{type:$.value?"success":"warning",size:"small"},{default:o(()=>[g(c($.value?"HTTPS":"HTTP"),1)]),_:1},8,["type"]),n(h,{type:W.value,size:"small"},{default:o(()=>[g(c(F.value),1)]),_:1},8,["type"])])])]),s("div",Re,[s("div",Ve,[s("div",Ie,c(E.value.blockedThreats),1),e[6]||(e[6]=s("div",{class:"stat-label"},"å·²é˜»æ­¢å¨èƒ",-1))]),s("div",Me,[s("div",Ee,c(E.value.totalThreats),1),e[7]||(e[7]=s("div",{class:"stat-label"},"æ£€æµ‹åˆ°å¨èƒ",-1))]),s("div",Ne,[s("div",Oe,c(N.value),1),e[8]||(e[8]=s("div",{class:"stat-label"},"ä»Šæ—¥é˜»æ­¢",-1))])]),M.value.length>0?(p(),b("div",je,[e[9]||(e[9]=s("h3",null,"æœ€è¿‘å¨èƒ",-1)),s("div",Ke,[(p(!0),b(de,null,fe(M.value.slice(0,3),i=>(p(),b("div",{key:i.id,class:"threat-item"},[n(a,{color:Q(i.level)},{default:o(()=>[n(f(j))]),_:1},8,["color"]),s("div",We,[s("div",Fe,c(Y(i.type)),1),s("div",qe,c(Z(i.timestamp)),1)]),n(h,{type:i.blocked?"success":"warning",size:"small"},{default:o(()=>[g(c(i.blocked?"å·²é˜»æ­¢":"å·²æ£€æµ‹"),1)]),_:2},1032,["type"])]))),128))])])):R("",!0),s("div",Ge,[n(l,{type:"primary",onClick:ee,loading:B.value,style:{flex:"1"}},{default:o(()=>[n(a,null,{default:o(()=>[n(f(he))]),_:1}),e[10]||(e[10]=g(" æ‰«æå½“å‰é¡µé¢ ",-1))]),_:1},8,["loading"]),n(l,{onClick:e[0]||(e[0]=i=>U.value=!0),type:"warning"},{default:o(()=>[n(a,null,{default:o(()=>[n(f(j))]),_:1}),e[11]||(e[11]=g(" AIæ£€æµ‹ ",-1))]),_:1}),n(l,{onClick:te},{default:o(()=>[n(a,null,{default:o(()=>[n(f(pe))]),_:1}),e[12]||(e[12]=g(" è®¾ç½® ",-1))]),_:1})]),n(P,{modelValue:U.value,"onUpdate:modelValue":e[2]||(e[2]=i=>U.value=i),title:"é’“é±¼ç½‘ç«™æ£€æµ‹",width:"90%","close-on-click-modal":!1},{default:o(()=>[s("div",Je,[n(H,{modelValue:T.value,"onUpdate:modelValue":e[1]||(e[1]=i=>T.value=i),placeholder:"è¾“å…¥è¦æ£€æµ‹çš„ç½‘å€ï¼Œä¾‹å¦‚: https://example.com",size:"large",clearable:""},{prepend:o(()=>[n(a,null,{default:o(()=>[n(f(ve))]),_:1})]),_:1},8,["modelValue"]),n(l,{type:"primary",onClick:se,loading:S.value,disabled:!T.value.trim(),style:{width:"100%","margin-top":"12px"},size:"large"},{default:o(()=>[g(c(S.value?"åˆ†æä¸­...":"å¼€å§‹æ£€æµ‹"),1)]),_:1},8,["loading","disabled"]),k.value?(p(),b("div",{key:0,class:me(["result-box",q.value])},[s("div",Xe,[n(a,{size:"24"},{default:o(()=>[L.value?(p(),z(f(_e),{key:0})):(p(),z(f(ge),{key:1}))]),_:1}),s("h3",null,c(G.value),1)]),s("div",{class:"result-content",innerHTML:k.value},null,8,Qe)],2)):R("",!0),S.value?(p(),b("div",Ye,[n(a,{class:"is-loading"},{default:o(()=>[n(f(ye))]),_:1}),e[13]||(e[13]=s("p",null,"AIæ­£åœ¨åˆ†æç½‘å€ç‰¹å¾ï¼Œè¯·ç¨å€™...",-1))])):R("",!0)])]),_:1},8,["modelValue"])])}}}),et=be(Ze,[["__scopeId","data-v-f3360750"]]),A=we(et),tt=Te();A.use(tt);A.use(ke);for(const[V,r]of Object.entries(Se))A.component(V,r);A.mount("#app");
